#!/bin/bash

clear
cat << "EOF"
[INIT.STATION89 — Глава 2: Видение Структуры]

Станция ожила, но лишь частично. Её сердце бьётся глухо — как эхо по коридорам, где давно не ступала нога.

Ты стоишь перед древней файловой системой, будто перед библиотекой затерянных миров.

Здесь каждый путь — это не просто адрес, а маршрут сквозь смысл,
каждая директория — обитель когда-то активных сущностей.

Ты ощущаешь: чтобы идти дальше, нужно научиться видеть.

EOF

echo
echo ">> [СТАНЦИЯ 89] ПРОБУЖДЕНИЕ ФАЙЛОВОЙ СТРУКТУРЫ"
sleep 1

# Функция проверки ответа (строгое совпадение)
ask_and_check() {
  local prompt="$1"
  local expected="$2"
  local user_input

  while true; do
    read -p "$prompt > " user_input
    if [[ "$user_input" == "$expected" ]]; then
      echo "Верно."
      break
    else
      echo "Неверно. Попробуй ещё раз."
    fi
  done
}

# Шаг 1: просмотр содержимого (не проверяем, а просто активируем внимание)
echo
echo ">> Ты чувствуешь, что нужно разглядеть пространство вокруг."
echo ">> Выполни команду 'ls' в терминале. Что ты видишь?"
read -p "> " _
echo ">> Хорошо. То, что ты видишь — это внешняя поверхность структуры."

# Шаг 2: где ты находишься?
echo
echo ">> А теперь: где ты находишься внутри этой структуры?"
ask_and_check "\$ pwd" "$(pwd)"

# Шаг 3: философия абсолютного и относительного пути
cat << "EOF"

Ты узнаёшь о двух способах восприятия мира:

— Абсолютный путь — как маршрут от корня всей реальности:
      /home/stalker/documents

— Относительный путь — как движение из текущей позиции:
      ../documents

Как и в жизни:
Иногда ты начинаешь путь с нуля. Иногда — с того, кем уже являешься.

EOF

# Завершение главы
echo
echo ">> Глава завершена. Готов ли ты к следующему шагу?"
while true; do
  read -p "> " input
  input=$(echo "$input" | tr '[:upper:]' '[:lower:]' | tr -d '[:space:]')
  if [[ "$input" == "next" ]]; then
    echo ">>> Переход к следующей главе..."
    exit 0
  elif [[ "$input" == "exit" ]]; then
    echo ">>> Завершение сеанса. До встречи в глубинах структуры."
    exit 0
  else
    echo "Неверный ввод. Введи 'next' или 'exit'."
  fi
done

